name: hysteria-client
version: '3.8'

volumes:
  {{ hysteria_client_compose_volumes_appendix | ansible.builtin.to_nice_yaml | indent(2) }}

services:

  hysteria:
    image: {{ ( 'tobyxdd/hysteria:' + hysteria_client_version ) | ansible.builtin.to_yaml }}
    restart: unless-stopped
    command: [ client, --config, /etc/hysteria.json ]

    ports:
      {{ hysteria_client_ports_appendix | ansible.builtin.to_nice_yaml | indent(6) }}

    volumes:
      - {{ ( config_file + ':/etc/hysteria.json' ) | ansible.builtin.to_yaml }}
{% if hysteria_client_volumes_appendix | length > 0 %}
      {{ hysteria_client_volumes_appendix | ansible.builtin.to_nice_yaml | indent(6) }}
{% endif %}

{% if hysteria_client_compose_services_hysteria_appendix | length > 0 %}
    {{ hysteria_client_compose_services_hysteria_appendix | ansible.builtin.to_nice_yaml | indent(4) }}
{% endif %}

{% if hysteria_client_compose_services_appendix | length > 0 %}
  {{ hysteria_client_compose_services_appendix | ansible.builtin.to_nice_yaml | indent(2) }}
{% endif %}

{% if hysteria_client_compose_appendix | length > 0 %}
{{ hysteria_client_compose_appendix | ansible.builtin.to_nice_yaml | indent(0) }}
{% endif %}

# vim:expandtab:shiftwidth=2
